module "workstation1vm" {
  source                       = "../../modules/virtual_machine_universal_win2016"
  application_acronym          = upper(var.application_acronym)
  project_name                 = var.application_acronym
  vm_environment               = var.environment_acronym
  vm_region                    = var.location_acronym
  vm_workload_desc             = "WST"
  enforce_vm_naming_convention = true
  resource_group_location      = module.applicationrg.resource_group_location
  resource_group_name          = module.applicationrg.resource_group_name
  tags                         = var.tags
  subnet_id                    = azurerm_subnet.rrimgtsubnet.id
  count_value                  = 1
  vm_size                      = var.vmMgt_Size
  availability_set_id          = ""
  azurerm_image_id             = ""
  publisher                    = "MicrosoftWindowsServer"
  offer                        = "WindowsServer"
  sku                          = "2016-Datacenter"
  storage_uri                  = ""
  data_disk_size               = 50
  template_file                = data.template_file.ps1.rendered
  template_file_xml            = ""
  loganalytics_workspace_id    = ""
  loganalytics_workspace_key   = ""
  storage_account_name         = ""
  storage_account_key          = ""
  client_id                    = ""
  diskencryption_keyvault      = ""
  backup_resource_group_name   = ""
  recovery_vault_name          = ""
  backup_policy_id             = ""
  domain_name                  = ""
  ou_path                      = ""
  domain_user_name             = ""
  domain_user_password         = ""
  admin_username               = lower("${var.application_acronym}WST1${var.environment_acronym}ADMIN")
  admin_password               = var.admin_password
  encryptappsp_key_password    = ""
}

module "powerbigateway1vm" {
  source                       = "../../modules/virtual_machine_universal_win2016"
  application_acronym          = upper(var.application_acronym)
  project_name                 = var.application_acronym
  vm_environment               = var.environment_acronym
  vm_region                    = var.location_acronym
  vm_workload_desc             = "PBI"
  enforce_vm_naming_convention = true
  resource_group_location      = module.applicationrg.resource_group_location
  resource_group_name          = module.applicationrg.resource_group_name
  tags                         = var.tags
  subnet_id                    = azurerm_subnet.rripbisubnet.id
  count_value                  = 1
  vm_size                      = var.vmPbi_Size
  availability_set_id          = ""
  azurerm_image_id             = ""
  publisher                    = "MicrosoftWindowsServer"
  offer                        = "WindowsServer"
  sku                          = "2016-Datacenter"
  storage_uri                  = ""
  data_disk_size               = 50
  template_file                = data.template_file.ps1.rendered
  template_file_xml            = ""
  loganalytics_workspace_id    = ""
  loganalytics_workspace_key   = ""
  storage_account_name         = ""
  storage_account_key          = ""
  client_id                    = ""
  diskencryption_keyvault      = ""
  backup_resource_group_name   = ""
  recovery_vault_name          = ""
  backup_policy_id             = ""
  domain_name                  = ""
  ou_path                      = ""
  domain_user_name             = ""
  domain_user_password         = ""
  admin_username               = lower("${var.application_acronym}PBI1${var.environment_acronym}ADMIN")
  admin_password               = var.admin_password
  encryptappsp_key_password    = ""
}

